{% load static %}
<nav class="fixed top-0 left-0 z-40 w-screen bg-white shadow-md font-['Poppins']">
    <div class="w-full mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <img src="{% static 'images/logo.png' %}"
                     alt="RosoJogja logo"
                     class="h-10 w-10 mr-2" />
                <a href="{% url 'main:show_main' %}">
                    <h1 class="text-xl font-bold text-[#FF7043] text-center">RosoJogja</h1>
                </a>
            </div>
            <div class="hidden md:flex items-center max-h-full">
                <a href="{% url 'main:show_main' %}"
                   class="text-[#333333] text-sm font-bold py-2 px-4 transition duration-300 text-center hover:text-[#FF7043]">Home</a>
                <a href="{% url 'restaurant:show_restaurants' %}"
                   class="text-[#333333] text-sm font-bold py-2 px-4 transition duration-300 text-center hover:text-[#FF7043]">Restaurants</a>
                {% if user.is_authenticated and user.role == 'C' %}
                    <a href="{% url 'order:show_cart' %}"
                       class="text-[#333333] text-sm font-bold py-2 px-4 transition duration-300 text-center hover:text-[#FF7043]">Cart</a>
                {% endif %}
                {% if user.is_authenticated %}
                    <a href="{% url 'promo:promo_home' %}"
                       class="text-[#333333] text-sm font-bold py-2 px-4 transition duration-300 text-center hover:text-[#FF7043]">Promo</a>
                    <!-- Wishlist dengan badge jumlah -->
                    <a href="{% url 'wishlist:wishlist_view' %}"
                       class="text-[#333333] text-sm font-bold py-2 px-4 transition duration-300 text-center hover:text-[#FF7043]">
                        <!-- Wishlist Logo -->
                        <span>Wishlist</span>
                        <span id="wishlist-count"
                              class="hidden bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center absolute top-0 right-0 -mr-2 -mt-1">0</span>
                    </a>
                {% endif %}
            </div>
            <div class="hidden md:flex items-center max-h-full relative">
                {% if user.is_authenticated %}
                    <div class="flex items-center relative gap-2">
                        <div class="flex items-center">
                            <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'images/default_profile_picture.png' %}{% endif %}"
                                 alt="User profile image"
                                 class="object-cover h-8 w-8 rounded-full mr-1" />
                            <button id="dropdown-trigger" class="focus:outline-none ml-1">
                                <svg class="w-4 h-4 text-[#333333] transition-transform"
                                     fill="none"
                                     stroke="currentColor"
                                     viewBox="0 0 24 24"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>
                        </div>
                        <!-- Dropdown Menu -->
                        <div id="dropdown-menu"
                             class="hidden absolute top-12 right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg">
                            {% if user.role == 'C' %}
                                <a href="{% url 'order:show_order_history' %}"
                                   class="block px-4 py-2 text-sm text-[#333333] hover:bg-gray-100 hover:text-[#FF7043]">Order History</a>
                            {% endif %}
                            <a href="{% url 'main:logout' %}"
                               class="block px-4 py-2 text-sm text-[#333333] hover:bg-gray-100 hover:text-[#FF7043]">Logout</a>
                        </div>
                    </div>
                {% else %}
                    <a href="{% url 'main:login' %}"
                       class="bg-[#FF7043] text-white text-sm font-bold py-2 px-4 rounded transition duration-300 text-center mr-2 hover:bg-orange-600">Login</a>
                    <a href="{% url 'main:register' %}"
                       class="bg-[#D13529] text-white text-sm font-bold py-2 px-4 rounded transition duration-300 text-center hover:bg-red-800">Register</a>
                {% endif %}
            </div>
            <div class="md:hidden flex items-center">
                <button class="mobile-menu-button">
                    <svg class="w-6 h-6 text-[#D13529]"
                         fill="none"
                         stroke-linecap="round"
                         stroke-linejoin="round"
                         stroke-width="2"
                         viewBox="0 0 24 24"
                         stroke="currentColor">
                        <path d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    <!-- Mobile menu -->
    <div class="mobile-menu hidden md:hidden px-4 w-full md:max-w-full">
        <div class="pt-2 pb-3 space-y-1 mx-auto">
            {% if user.is_authenticated %}
                <<<<<<< HEAD
                <div class="border-b-2 flex flex-row items-center justify-center py-2"
                     style="border-color: #D0A070">
                    =======
                    <div class="border-b-2 flex flex-row items-center justify-center py-2 border-[#D0A070]">
                        >>>>>>> aa6b7bba68bd351117ecc3d2dc4e044e4312fa40
                        <div class="flex justify-center items-center px-2">
                            <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'images/default_profile_picture.png' %}{% endif %}"
                                 alt="User profile image"
                                 class="object-cover h-8 w-8 rounded-full" />
                        </div>
                        <span class="text-[#333333] text-sm block px-3 py-2">Welcome, <b>{{ user.username }}</b></span>
                    </div>
                    <!-- Authenticated User Links -->
                    <a href="{% url 'main:show_main' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Home</a>
                    <a href="{% url 'restaurant:show_restaurants' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Restaurants</a>
                    {% if user.role == 'C' %}
                        <a href="{% url 'order:show_cart' %}"
                           class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                           style="font-size: 0.875rem">Cart</a>
                    {% endif %}
                    <a href="{% url 'promo:promo_home' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Promo</a>
                    {% if user.role == 'C' %}
                        <a href="{% url 'order:show_order_history' %}"
                           class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                           style="font-size: 0.875rem">Order History</a>
                    {% endif %}
                    <a href="{% url 'main:logout' %}"
                       class="block text-center font-bold py-2 px-4 rounded transition duration-300"
                       style="background-color: #D13529;
                              color: #FFFFFF;
                              font-size: 0.875rem">Logout</a>
                {% else %}
                    <!-- Guest User Links -->
                    <<<<<<< HEAD
                    <a href="{% url 'main:show_main' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Home</a>
                    <a href="{% url 'restaurant:show_restaurants' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Restaurants</a>
                    <a href="{% url 'main:login' %}"
                       class="block text-center font-bold py-2 px-4 rounded transition duration-300 mb-2"
                       style="background-color: #FF7043;
                              color: #FFFFFF;
                              font-size: 0.875rem">Login</a>
                    <a href="{% url 'main:register' %}"
                       class="block text-center font-bold py-2 px-4 rounded transition duration-300"
                       style="background-color: #D13529;
                              color: #FFFFFF;
                              font-size: 0.875rem">Register</a>
                    =======
                    <a href="{% url 'main:show_main' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Home</a>
                    <a href="{% url 'restaurant:show_restaurants' %}"
                       class="block text-center font-bold py-2 px-4 transition duration-300 text-[#333333] hover:text-[#FF7043]"
                       style="font-size: 0.875rem">Restaurants</a>
                    <a href="{% url 'main:login' %}"
                       class="block text-center font-bold py-2 px-4 rounded transition duration-300 mb-2"
                       style="background-color: #FF7043;
                              color: #FFFFFF;
                              font-size: 0.875rem">Login</a>
                    <a href="{% url 'main:register' %}"
                       class="block text-center font-bold py-2 px-4 rounded transition duration-300"
                       style="background-color: #D13529;
                              color: #FFFFFF;
                              font-size: 0.875rem">Register</a>
                    >>>>>>> aa6b7bba68bd351117ecc3d2dc4e044e4312fa40
                {% endif %}
            </div>
        </div>
        <script>
        // Mobile menu functionality
        const btn = document.querySelector("button.mobile-menu-button");
        const menu = document.querySelector(".mobile-menu");

        btn.addEventListener("click", () => {
            menu.classList.toggle("hidden");
        });

        // Profile dropdown functionality
        const dropdownTrigger = document.getElementById('dropdown-trigger');
        const dropdownMenu = document.getElementById('dropdown-menu');
        let isDropdownOpen = false;

        if (dropdownTrigger && dropdownMenu) {
            // Toggle dropdown when clicking the chevron
            dropdownTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                isDropdownOpen = !isDropdownOpen;
                dropdownMenu.classList.toggle('hidden');
                dropdownTrigger.querySelector('svg').style.transform = isDropdownOpen ? 'rotate(180deg)' : 'rotate(0)';
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!dropdownMenu.contains(e.target) && !dropdownTrigger.contains(e.target)) {
                    dropdownMenu.classList.add('hidden');
                    dropdownTrigger.querySelector('svg').style.transform = 'rotate(0)';
                    isDropdownOpen = false;
                }
            });
        }
        </script>
    </nav>
