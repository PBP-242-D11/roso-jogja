{% load static %}
<nav style="background-color: #FFFFFF; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);" class="fixed top-0 left-0 z-40 w-screen font-['Poppins']">
    <div class="w-full mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <img src="{% static 'images/logo.png' %}" alt="RosoJogja logo" class="h-10 w-10 mr-2" />
                <a href="{% url 'main:show_main' %}">
                    <h1 style="font-size: 1.5rem; font-weight: bold; color: #FF7043;" class="text-center">RosoJogja</h1> <!-- Ukuran font diubah di sini -->
                </a>
            </div>
            <div class="hidden md:flex items-center max-h-full">
                <a href="{% url 'main:show_main' %}" style="color: #333333; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 transition duration-300">Home</a>
                <a href="{% url 'restaurant:show_restaurants' %}" style="color: #333333; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 transition duration-300">Restaurants</a>
                {% if user.is_authenticated and user.role == 'C' %}
                    <a href="{% url 'order:show_cart' %}" style="color: #333333; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 transition duration-300">Cart</a>
                {% endif %}
                {% if user.is_authenticated %}
                    <a href="{% url 'promo:promo_home' %}" style="color: #333333; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 transition duration-300">Promo</a>
                {% endif %}
            </div>
            <div class="hidden md:flex items-center max-h-full relative">
                {% if user.is_authenticated %}
                    <div class="flex items-center relative gap-2">
                        <div class="flex items-center">
                            <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'images/default_profile_picture.png' %}{% endif %}"
                                 alt="User profile image"
                                 class="object-cover h-8 w-8 rounded-full mr-1" />
                            <button id="dropdown-trigger" class="focus:outline-none ml-1">
                                <svg class="w-4 h-4 text-gray-800 transition-transform"
                                     fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>
                        </div>
                        <!-- Dropdown Menu -->
                        <div id="dropdown-menu" class="hidden absolute top-12 right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg">
                            <a href="{% url 'order:show_order_history' %}" class="block px-4 py-2 text-sm text-gray-800 hover:bg-gray-100">Order History</a>
                            <a href="{% url 'main:logout' %}" class="block px-4 py-2 text-sm text-gray-800 hover:bg-gray-100">Logout</a>
                        </div>
                    </div>
                {% else %}
                    <a href="{% url 'main:login' %}" style="background-color: #FF7043; color: #FFFFFF; font-size: 0.875rem;" class="text-center font-bold py-2 px-4 rounded transition duration-300 mr-2">
                        Login
                    </a>
                    <a href="{% url 'main:register' %}" style="background-color: #D13529; color: #FFFFFF; font-size: 0.875rem;" class="text-center font-bold py-2 px-4 rounded transition duration-300">
                        Register
                    </a>
                {% endif %}
            </div>
            <div class="md:hidden flex items-center">
                <button class="mobile-menu-button">
                    <svg class="w-6 h-6" style="color: #D13529;" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor">
                        <path d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    <!-- Mobile menu -->
    <div class="mobile-menu hidden md:hidden px-4 w-full md:max-w-full">
        <div class="pt-2 pb-3 space-y-1 mx-auto">
            {% if user.is_authenticated %}
                <div class="border-b-2 flex flex-row items-center justify-center py-2" style="border-color: #D0A070;">
                    <div class="flex justify-center items-center px-2">
                        <img src="{% if user.profile_picture %}{{ user.profile_picture.url }}{% else %}{% static 'images/default_profile_picture.png' %}{% endif %}" alt="User profile image" class="object-cover h-8 w-8 rounded-full" />
                    </div>
                    <span style="color: #333333; font-size: 0.875rem;" class="block px-3 py-2">Welcome, <b>{{ user.username }}</b></span>
                </div>
                <a href="{% url 'restaurant:show_restaurants' %}" style="color: #333333; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 transition duration-300">Restaurants</a>
                <a href="{% url 'main:logout' %}" style="background-color: #D13529; color: #FFFFFF; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 rounded transition duration-300">
                    Logout
                </a>
            {% else %}
                <a href="{% url 'main:login' %}" style="background-color: #FF7043; color: #FFFFFF; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 rounded transition duration-300 mb-2">
                    Login
                </a>
                <a href="{% url 'main:register' %}" style="background-color: #D13529; color: #FFFFFF; font-size: 0.875rem;" class="block text-center font-bold py-2 px-4 rounded transition duration-300">
                    Register
                </a>
            {% endif %}
        </div>
    </div>
    <script>
        // Mobile menu functionality
        const btn = document.querySelector("button.mobile-menu-button");
        const menu = document.querySelector(".mobile-menu");

        btn.addEventListener("click", () => {
            menu.classList.toggle("hidden");
        });

        // Profile dropdown functionality
        const dropdownTrigger = document.getElementById('dropdown-trigger');
        const dropdownMenu = document.getElementById('dropdown-menu');
        let isDropdownOpen = false;

        if (dropdownTrigger && dropdownMenu) {
            // Toggle dropdown when clicking the chevron
            dropdownTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                isDropdownOpen = !isDropdownOpen;
                dropdownMenu.classList.toggle('hidden');
                dropdownTrigger.querySelector('svg').style.transform = isDropdownOpen ? 'rotate(180deg)' : 'rotate(0)';
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!dropdownMenu.contains(e.target) && !dropdownTrigger.contains(e.target)) {
                    dropdownMenu.classList.add('hidden');
                    dropdownTrigger.querySelector('svg').style.transform = 'rotate(0)';
                    isDropdownOpen = false;
                }
            });
        }
    </script>
</nav>